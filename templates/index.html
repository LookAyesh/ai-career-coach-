<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Career Coach</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;700;800&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: #020617; /* Dark blue background */
            overflow: hidden;
        }
        .gradient-text {
            background: linear-gradient(90deg, #60a5fa, #c084fc);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        #bg-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0; /* Behind content */
        }
        .content-wrapper {
            position: relative;
            z-index: 1; /* In front of canvas */
        }
        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .button-glow:hover {
            box-shadow: 0 0 20px rgba(96, 165, 250, 0.5), 0 0 30px rgba(192, 132, 252, 0.4);
        }
    </style>
</head>
<body>
    <canvas id="bg-canvas"></canvas>

    <div class="content-wrapper">
        <header class="bg-transparent fixed top-0 left-0 right-0 z-10">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center h-16">
                    <div class="flex-shrink-0">
                        <a href="{{ url_for('index') }}" class="flex items-center space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-blue-400"><path d="M3 7V5a2 2 0 0 1 2-2h2"/><path d="M17 3h2a2 2 0 0 1 2 2v2"/><path d="M21 17v2a2 2 0 0 1-2 2h-2"/><path d="M7 21H5a2 2 0 0 1-2-2v-2"/><circle cx="12" cy="12" r="3"/><path d="m16 16-1.9-1.9"/></svg>
                            <span class="text-xl font-bold text-gray-200">AI Career Coach</span>
                        </a>
                    </div>
                </div>
            </div>
        </header>

        <main class="min-h-screen flex items-center justify-center pt-16 p-4">
            <div class="w-full max-w-5xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
                <!-- Left Column: Text Content -->
                <div class="text-center md:text-left">
                    <h1 class="text-4xl md:text-5xl font-extrabold text-white leading-tight">
                        Resume Evaluation & <span class="gradient-text">Expert Coaching</span>
                    </h1>
                    <p class="mt-4 text-lg text-gray-400">
                        Transform your career journey with professional guidance. Upload your resume for expert evaluation and personalized coaching.
                    </p>
                </div>

                <!-- Right Column: Upload Form -->
                <div class="glass-card p-8 rounded-2xl shadow-2xl">
                     <h2 class="text-2xl font-bold text-white text-center mb-6">Upload Your Resume</h2>
                    
                    {% with messages = get_flashed_messages() %}
                      {% if messages %}
                        <div class="bg-red-900/50 border border-red-700 text-red-300 px-4 py-3 rounded-lg relative mb-4" role="alert">
                          <strong class="font-bold">Oops!</strong>
                          <span class="block sm:inline">{{ messages[0] }}</span>
                        </div>
                      {% endif %}
                    {% endwith %}

                    <form action="{{ url_for('upload_file') }}" method="post" enctype="multipart/form-data">
                        <input id="file-upload" name="file" type="file" accept=".pdf" required 
                               class="block w-full text-sm text-gray-400 border border-gray-600 rounded-lg cursor-pointer bg-gray-900/50 focus:outline-none
                                      file:mr-4 file:py-3 file:px-5 file:rounded-l-lg file:border-0
                                      file:text-sm file:font-semibold file:bg-blue-600 file:text-white hover:file:bg-blue-700">
                        
                        <div id="file-name-display" class="mt-3 text-sm text-center text-gray-500 h-5"></div>

                        <button type="submit" class="mt-4 w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 focus:ring-4 focus:ring-blue-500/50 transition-all button-glow">
                            Analyze My Resume
                        </button>
                    </form>
                </div>
            </div>
        </main>
    </div>

    <!-- JavaScript for file name display -->
    <script>
        const fileInput = document.getElementById('file-upload');
        const fileNameDisplay = document.getElementById('file-name-display');
        
        fileInput.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (file) {
                fileNameDisplay.textContent = Selected file: ${file.name};
            } else {
                fileNameDisplay.textContent = '';
            }
        });
    </script>

    <!-- JavaScript for the 3D Background -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // --- Scene Setup ---
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 5;
        const renderer = new THREE.WebGLRenderer({
            canvas: document.getElementById('bg-canvas'),
            alpha: true
        });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));

        // --- Lighting ---
        const pointLight = new THREE.PointLight(0x8b5cf6, 20, 10); // Purple light
        pointLight.position.set(0, 0, 2);
        scene.add(pointLight);
        const ambientLight = new THREE.AmbientLight(0x3b82f6, 0.5); // Blue ambient
        scene.add(ambientLight);

        // --- Crystal Core ---
        const coreGeometry = new THREE.IcosahedronGeometry(1, 0);
        const coreMaterial = new THREE.MeshStandardMaterial({
            color: 0xffffff,
            emissive: 0x60a5fa,
            emissiveIntensity: 0.5,
            roughness: 0.2,
            metalness: 0.8,
            transparent: true,
            opacity: 0.8
        });
        const crystalCore = new THREE.Mesh(coreGeometry, coreMaterial);
        scene.add(crystalCore);

        // --- Orbiting Particles ---
        const particlesGeometry = new THREE.BufferGeometry();
        const particlesCount = 7000;
        const posArray = new Float32Array(particlesCount * 3);
        for (let i = 0; i < particlesCount * 3; i++) {
            const radius = Math.random() * 4 + 1.5;
            const theta = Math.random() * Math.PI * 2;
            const phi = Math.acos(2 * Math.random() - 1);
            posArray[i * 3 + 0] = radius * Math.sin(phi) * Math.cos(theta); // x
            posArray[i * 3 + 1] = radius * Math.sin(phi) * Math.sin(theta); // y
            posArray[i * 3 + 2] = radius * Math.cos(phi); // z
        }
        particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
        const particlesMaterial = new THREE.PointsMaterial({
            size: 0.008,
            color: 0x60a5fa,
            blending: THREE.AdditiveBlending,
            transparent: true,
            opacity: 0.7
        });
        const particlesMesh = new THREE.Points(particlesGeometry, particlesMaterial);
        scene.add(particlesMesh);

        // --- Mouse Interaction ---
        const mouse = new THREE.Vector2();
        document.addEventListener('mousemove', (event) => {
            mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
        });

        // --- Animation Loop ---
        const clock = new THREE.Clock();
        const animate = () => {
            const elapsedTime = clock.getElapsedTime();

            // Animate crystal
            crystalCore.rotation.y = 0.2 * elapsedTime;
            crystalCore.rotation.x = 0.1 * elapsedTime;
            crystalCore.position.y = Math.sin(elapsedTime * 0.5) * 0.1;

            // Animate particles
            particlesMesh.rotation.y = -0.05 * elapsedTime;

            // Animate camera based on mouse
            camera.position.x += (mouse.x * 0.5 - camera.position.x) * 0.05;
            camera.position.y += (mouse.y * 0.5 - camera.position.y) * 0.05;
            camera.lookAt(scene.position);

            renderer.render(scene, camera);
            requestAnimationFrame(animate);
        };
        animate();

        // --- Handle Window Resizing ---
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        });
    </script>
</body>
</html>